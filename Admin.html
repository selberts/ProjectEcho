<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="assets/ico/favicon.png">

    <title>Project Echo - IM Scheduler</title>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap.css" rel="stylesheet">
    <link href="assets/css/font-awesome.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="assets/css/main.css" rel="stylesheet">

    <!-- Database calls source-->
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.2.18.min.js"></script>


    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>

  <body onload="makeslots()">

    <!-- Fixed navbar -->
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">NU INTRAMURAL SP<i class="fa fa-circle"></i>RTS</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="index.html">HOME</a></li>
            <li><a href="about.html">ABOUT</a></li>
            <li><a href="calendar.html">CALENDAR</a></li>
            <li><a href="schedule.html">SCHEDULE</a></li>
            <li class="active"><a href="Admin.html">Admin</a></li>
            
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
    
    	<div id="dg">
		<div class="container">
			<div class="row centered">
				<h4>ADD TIMESLOTS</h4>
				
				<form id="password" style="display: inline-block" onsubmit="return submitPass()">
                                    <input type="text" id="name" value="Password" />
                                    <input type="submit" value="Submit">
                                </form>
                                
        
        <form id="team_info" style="display: inline-block" onsubmit="return sub()">
                                    <input type="text" id="name" value="Team name" />
                                    <input type="button" id="addpref" value="Add pref" onclick="createPref()"/>
                                    <input type="submit" value="Submit">
                                </form>
        <script type="text/javascript">

            Parse.initialize("r3WndIFb85R0lx1qhchN4nquvAQVeKVrkA3TBnpI", "Wui7puCTZpnTmA5ZLvJmlj5R044vAyDerOBXhYzq");
            
            function submitPass(){
            	return false;
            }
            /**
             * Callback function for form submission
             * Prepares name and pref_times, pref_days arrays for local storage
             * @returns {bool}  false signals page not to reload (ie, not sending info to webserve)
             */
            function sub(){
                /*  Uncomment to require 3 preferences 
               if(prefNum != 3) {
                   alert("Need to add three preferences");
                   return false;
               }
               */

               var pref_times = new Array();
               var pref_days = new Array();                
               var name = document.getElementById("name").value;
               
               var daySelects = document.getElementsByName("prefDay");
               var timeSelects = document.getElementsByName("prefTime");
                                             
               for(var i=0; i<daySelects.length; i++){ 
                   pref_times.push(timeSelects.item(i).value);
                   pref_days.push(daySelects.item(i).value);
               }
               
               /*
               // What to do with this information? Depends on our storage scheme
               var id = -1; // retrieved from local storage
               var team = {
				id: i +1, 
				team_name: name, 
				pref_times: pref_times,
				pref_days: pref_days
				};
                //<team stored locally>
               */
               var Teamdata = Parse.Object.extend("Teamdata");
               var teamdata = new Teamdata();
               teamdata.save({team_name: name , type:"team" , pref_days:pref_days , pref_times:pref_times}).then(function(object) {
	      console.log("Team successfully added.");
	      var success = document.createElement("div");
	      var loc = document.getElementById('dg');
	      success.innerHTML = "Timeslot successfully added to database";
	      success.style.display = 'block';
	      loc.appendChild(success);
               });

               
               

               return false;
                
            }
            
            var prefNum = 0;
            var timeslot_list;
            var days = ["Sunday", "Monday","Tuesday","Wednesday","Thursday"];

            function makeslots() {
		timeslot_list = []
		i = 1;
		for (var day = 0; day < 5; day ++) {
			for (var time = 5; time < 10; time ++) {
				//for (var c = 1; c <7; c++) {
					var slot = new Time_Slot(i, time+ " PM", days[day], 2);
					timeslot_list.push(slot);
					i ++;
				//};
			};
		};
            }

            
            /**
             * Adds preference selects (time, day) to form
             * Limited to 3 preferences 
             * @returns {undefined}
             */
            function createPref(){
                var form = document.getElementById('team_info');
                var button = document.getElementById('addpref');
                
                
                var div = document.createElement("div");
                div.style.display = 'block';
                div.appendChild(createTimeSelect(prefNum));
                div.appendChild(createDaySelect(prefNum));
                form.insertBefore(div, button);
                
                prefNum++;
                if(prefNum == 20) form.removeChild(button);
            }
            
            /**
             * Creates a select with values for each of the time preference choices
             * @param {int} prefNum                         Preference number                      
             * @returns {createTimeSelect.select|Element}   Select created
             */
            function createTimeSelect(prefNum){
                var select = document.createElement("select");
                select.name = "prefTime";// + prefNum;
                
                for (var i = 0; i < timeslot_list.length; i++){
                    var opt = document.createElement('option');
                    opt.value = timeslot_list[i].time;
                    opt.innerHTML = timeslot_list[i].time;
                    select.appendChild(opt);
                }
                
                return select;
            }
            
            /**
             * Creates a select with values for each of the day preference choices
             * @param {int} prefNum                         Preference number                      
             * @returns {createTimeSelect.select|Element}   Select created
             */
            function createDaySelect(prefNum){
                var select = document.createElement("select");
                select.name = "prefDay";// + prefNum;
                
                for (var i = 0; i < timeslot_list.length; i++){
                    var opt = document.createElement('option');
                    opt.value = timeslot_list[i].day;
                    opt.innerHTML = timeslot_list[i].day;
                    select.appendChild(opt);
                }
                
                return select;
            }
            
        </script>





        <script src="calendarAPI.js"></script>
        <script src="Classes.js"></script>



			</div><!-- row -->
		</div><!-- container -->
	</div><!-- DG -->
